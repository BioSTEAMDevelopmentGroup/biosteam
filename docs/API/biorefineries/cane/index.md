# Cane Biorefineries and Benchmarks

The `cane` module contains sugarcane, oilcane, and energycane biorefinery configurations, 
as discussed in [[1]](#1). 

```{toctree}
:hidden:
chemicals
systems
units
```

Getting started
---------------

Three configurations are currently available: (i) fermentation of juice and 
direct cogeneration (DC) of heat and power from bagasse, (ii) integrated 
co-fermentation (ICF) of both juice and bagasse hydrolysate, and (iii) integrated 
co-fermentation and recovery (ICFR) of plant and microbial oil. Either ethanol or
microbial an be produced at DC and ICF configurations. In all 
configurations, either sugarcane or oilcane is crushed to release the juice and 
the free oil is recovered from the fermentation effluent through a 3-phase decanter
centrifuge. In the DC configuration, the bagasse is sent directly to the boiler to produce 
heat and power. In the ICF and ICFR configurations, the bagasse is pretreated 
with liquid hot water, hydrolyzed with cellulases, and co-fermented with the 
juice.  In the DC and ICF configurations, the oil in the cell mass is recovered mechanically with a screw press after drying. 
In the ICFR, the oil in the cell mass is recovered by centrifugation after cellulosic 
pretreatment with the bagasse.

The following table details the options available for loading a biorefinery:

| Name | Feedstock | Configuration | Final products      | Fermentation |
| ---- | --------- | ------------- | ------------------- | ------------ |
| S1   | Sugarcane | DC            | Ethanol             | Batch        |
| S2   | Sugarcane | ICF           | Ethanol             | Batch        |
| O1   | Oilcane   | DC            | Ethanol & biodiesel | Batch        |
| O2   | Oilcane   | ICF           | Ethanol & biodiesel | Batch        |
| O3   | Oilcane   | DC            | Ethanol & crude oil | Batch        |
| O4   | Oilcane   | ICF           | Ethanol & crude oil | Batch        |
| O5   | Oilcane   | DC            | Biodiesel           | Fed-batch    |
| O6   | Oilcane   | ICF           | Biodiesel           | Fed-batch    |
| O7   | Oilcane   | DC            | Biodiesel           | Batch        |
| O8   | Oilcane   | ICFR          | Biodiesel           | Batch        |
| O9   | Oilcane   | ICF           | Biodiesel           | Batch        |

To select a specific cane line (e.g., sugarcane-WT or oilcane-1566) as described in 
[[2]](#2), add the name of the line after a period. For example, "O5.WT" is the 
DC biorefinery processing traditional sugarcane to biodiesel 
(through microbial oil production) and "O7.1566" is the 
ICF biorefinery processing oilcane prototype 1566 to biodiesel (from plant and microbial oils).

For sweet sorghum and oil-sorghum integration, add a '*'. For example, "S1*" is
the DC biorefinery producing ethanol from sugarcane and sweet sorghum and "O2*"
is the ICF biorefinery co-producing ethanol and biodiesel from oilcane and oil-sorghum.

The default assumptions on market prices, technological performance, and wastewater
treatment are set to those used in the 2022 publication [[1]](#1). For updated 
assumptions used in 2023-2024 publications (e.g., updated market prices,
oilcane oil contents, and high-rate wastewater treatment of bagasse),
run the function "YRCP2023()" before loading biorefineris.

Here is an example for loading the ICF biorefinery producing biodiesel from
oilcane 1566 using 2023-2024 assumptions. Note that all unit operations, streams, 
systems, parameters, and metrics are available as attrbitutes to the Biorefinery object:

```python
>>> import biorefineries.cane as c
>>> c.YRCP2023()
>>> O7 = c.Biorefinery('O7.1566') # Create biorefinery
>>> O7.sys.diagram() # View autogenerated process flowsheet
```

![Alt text](images/O7.png)

```python
>>> O7.R201.show() # All objects are available through the biorefinery object
AeratedFermentation: R201
ins...
[0] s28  from  HXutility-H201
    phase: 'l', T: 303.15 K, P: 101325 Pa
    flow (kmol/hr): Water                 8.27e+03
                    Glucose               10.8
                    Sucrose               64.1
                    H3PO4                 0.247
                    Phosphatidylinositol  0.0839
                    OleicAcid             0.29
                    TriOlein              0.673
[1] s140  
    phase: 'g', T: 305.15 K, P: 101325 Pa
    flow (kmol/hr): O2  275
                    N2  1.04e+03
outs...
[0] vent  
    phase: 'g', T: 305.15 K, P: 101325 Pa
    flow (kmol/hr): CO2  233
                    O2   197
                    N2   1.04e+03
[1] s29  to  StorageTank-T201
    phase: 'l', T: 305.15 K, P: 101325 Pa
    flow (kmol/hr): Water                 8.52e+03
                    Glucose               0.0907
                    H3PO4                 0.247
                    Yeast                 310
                    Glycerol              0.155
                    Phosphatidylinositol  0.0839
                    OleicAcid             0.768
                    ...                   5.61
```

Here are some additional examples:

```python
>>> import biorefineries.cane as c
>>> S1 = c.Biorefinery('S1') # Load conventional sugarcane biorefinery
>>> S1.sys.show(data=False) # Full system
System: sugarcane_sys
Highest convergence error among components in recycle
stream M201-0 after 5 loops:
- flow rate   9.09e-13 kmol/hr (0%)
- temperature 4.25e-06 K (1.3e-06%)
ins...
[0] sugarcane  
[1] H3PO4  
[2] lime  
[3] polymer  
[4] denaturant  
outs...
[0] advanced_ethanol  
[1] vinasse  
[2] fiber_fines  
[3] emissions  
[4] ash_disposal  

>>> O1 = c.Biorefinery('O1') # Load direct cogeneration oilcane configuration
>>> O1 = O1.sys.show(data=False)
System: oilcane_sys
Highest convergence error among components in recycle
streams {S301-0, T901-0} after 3 loops:
- flow rate   4.24e-03 kmol/hr (0.65%)
- temperature 0.00e+00 K (0%)
ins...
[0] oilcane  
outs...
[0] advanced_ethanol  
[1] biodiesel  
[2] crude_glycerol  
[3] vinasse  

```

To retrieve economic and environmental results at different scenarios, you can 
use the Model object:

```python
>>> import biorefineries.cane as c
>>> O2 = c.Biorefinery('O2') # Load integrated co-fermentation oilcane configuration
>>> parameters = O2.model.get_baseline_sample() # All parameters at the baseline scenario
>>> parameters
-                                  Juicing oil recovery [%]                         60
                                   Microbial oil recovery [%]                       50
                                   Bagasse oil recovery [%]                         70
                                   Cane operating days [day/y]                     180
                                   Sorghum operating days [day/y]                   45
Feedstock                          Available land [ha]                        1.87e+04
                                   Dry biomass yield [DMT/ha/y]                   25.6
Crude oil                          Price [USD/L]                                  64.9
Feedstock                          Price [USD/kg]                                0.035
Ethanol                            Price [USD/L]                                 0.368
Biodiesel                          Price [USD/L]                                 0.701
RIN D3                             Price [USD/RIN]                               0.534
RIN D4                             Price [USD/RIN]                               0.206
RIN D5                             Price [USD/RIN]                               0.205
Natural gas                        Price [USD/m3]                                0.167
Electricity                        Price [USD/kWh]                              0.0641
-                                  IRR [%]                                          10
Crude glycerol                     Price [USD/kg]                                 0.16
Pure glycerine                     Price [USD/kg]                                 0.65
Saccharification                   Reaction time [h]                                72
Cellulase                          Price [USD/kg]                                0.212
                                   Cellulase loading [wt. % cellulose]            0.02
Pretreatment reactor system        Base cost [million USD]                        19.7
Pretreatment and saccharification  Cane glucose yield [%]                           91
                                   Sorghum glucose yield [%]                        79
                                   Cane xylose yield [%]                          97.5
                                   Sorghum xylose yield [%]                         86
Cofermenation                      Glucose to ethanol yield [%]                     90
                                   Xylose to ethanol yield [%]                      42
Cofermentation                     Ethanol titer [g/L]                            68.5
                                   Ethanol productivity [g/L/h]                  0.951
Cofermenation                      Glucose to microbial oil yield [%]             13.2
                                   Xylose to microbial oil yield [%]              13.2
Fermentation                       Microbial oil titer [g/L]                      13.2
                                   Microbial oil productivity [g/L/h]             0.17
Oilcane                            Cane PL content [% oil]                          10
Oilsorghum                         Sorghum PL content [% oil]                       10
Oilcane                            Cane FFA content [% oil]                         10
Oilsorghum                         Sorghum FFA content [% oil]                      10
Oilcane                            Cane oil content [dry wt. %]                     10
Oilsorghum                         Relative sorghum oil content [dry wt. %]          0
-                                  TAG to FFA conversion [% oil]                    23
Sugarcane                          GWP [kg*CO2e/kg]                             0.0352
Methanol                           GWP [kg*CO2e/kg]                               0.45
Pure glycerine                     GWP [kg*CO2e/kg]                               1.67
Cellulase                          GWP [kg*CO2e/kg]                              0.404
Natural gas                        GWP [kg*CO2e/kg]                               0.33
-                                  Income tax [%]                                   21
dtype: float64

>>> parameters['oilcane', 'Cane oil content [dry wt. %]'] = 10 # Change oil content
>>> O2.model(parameters) # Evaluate at new oil content
-                        MFPP [USD/MT]                                       2.36
                         MESP [USD/L]                                       0.696
                         MBSP [USD/L]                                        1.92
                         Feedstock consumption [MT/y]                    1.61e+06
                         Biodiesel production [L/MT]                         26.8
                         Biodiesel yield [L/ha]                          2.31e+03
                         Ethanol production [L/MT]                           99.6
                         Electricity production [kWh/MT]                     68.5
                         Net energy production [GGE/MT]                      27.8
                         Natural gas consumption [m3/MT]                        0
                         TCI [10^6*USD]                                       512
                         Heat exchanger network error [%]               -3.79e-12
Economic allocation      GWP [kg*CO2e / USD]                                0.483
                         Ethanol GWP [kg*CO2e / L]                          0.365
                         Biodiesel GWP [kg*CO2e / L]                         0.62
                         Crude glycerol GWP [kg*CO2e / kg]                 0.0772
                         Electricity GWP [kg*CO2e / MWh]                     30.9
Displacement allocation  Ethanol GWP [kg*CO2e / L]                         -0.535
                         Biodiesel GWP [kg*CO2e / L]                        -1.98
Energy allocation        Biofuel GWP [kg*CO2e / GGE]                            2
                         Ethanol GWP [kg*CO2e / L]                          0.353
                         Biodiesel GWP [kg*CO2e / L]                        0.555
                         Crude-glycerol GWP [kg*CO2e / kg]                  0.212
-                        MFPP derivative [USD/MT]                           0.803
                         Biodiesel production derivative [L/MT]              2.68
                         Ethanol production derivative [L/MT]               -3.08
                         Electricity production derivative [kWh/MT]          5.79
                         Natural gas consumption derivative [cf/MT]             0
                         TCI derivative [10^6*USD]                           1.33
Economic allocation      GWP derivative [kg*CO2e / USD]                    -0.011
Ethanol                  GWP derivative [kg*CO2e / L]                    -0.00843
Biodiesel                GWP derivative [kg*CO2e / L]                     -0.0143
Crude glycerol           GWP derivative [kg*CO2e / kg]                   -0.00176
Electricity              GWP derivative [kg*CO2e / MWh]                    -0.705
-                        ROI [%]                                             1.59
Feedstock                Competitive biomass yield [dry MT/ha]                NaN
                         Energy competitive biomass yield [dry MT/ha]         NaN
-                        Breakeven IRR [%]                                  -2.48
dtype: float64

```

## References
<a id="1">[1]</a> 
    Cortés-Peña, Y.R., C.V. Kurambhatti, K. Eilts, V. Singh, J.S. Guest, “Economic and Environmental Sustainability of Vegetative Oil Extraction Strategies at Integrated Oilcane and Oil-sorghum Biorefineries,” ACS Sustainable Chemistry & Engineering.

